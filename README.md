Powershell Malware Analysis Toolbox

This repository contains a collection of powershell scripts designed to extract valuable information from potentially infected machines. These scripts provide a comprehensive approach to analyzing malware by gathering data related to processes, services, memory, logs, and network connections using various system-level tools and utilities.

Introduction

When dealing with potentially infected machines, it is crucial to gather as much information as possible to understand the nature of the threat and assess the extent of the compromise. This repository provides a set of scripts that automate the extraction of critical data points from suspicious systems. By examining processes, services, memory, logs, and network connections, these tools contribute to a comprehensive malware analysis process.
Prerequisites

Before using these scripts, ensure that you have the following prerequisites:

    Operating System: The scripts are primarily designed for Windows-based machines.
    WinPmem: Download the most recet version and drop it in the Scripts folder or compile it yourself, but make sure the final .exe file is named winpmem_mini_x64_rc2.exe (!!Case Sensitive!!)
    
Scripts

The repository contains the following scripts:
Process Extraction

The processes.ps1 script gathers information about the running processes on the target machine. It retrieves process names, IDs, parent process IDs, and other relevant details.
Service Extraction

The services.ps1 script extracts information about the services installed on the target machine. It retrieves service names, display names, descriptions, and startup types.
Memory Analysis

The memdump.ps1 script focuses on dumping the memory of potentially infected systems using WinPmem. It leverages memory forensics tools to extract valuable artifacts such as running processes, loaded modules, open network connections, and injected code. Get WinPmem here: https://github.com/Velocidex/WinPmem Remember to say thanks to the wonderful people that developed it.
Log Extraction

The logexport.ps1 script collects various logs from the target machine. It captures event logs, application logs, system logs, security logs, and other logs that might provide insights into the presence of malicious activities.
Network Analysis

The netstat.ps1 script utilizes the netstat command to capture active network connections, including listening ports, established connections, and associated process IDs. It helps identify potential malicious network behavior.
Usage

To use these scripts, follow these steps:

    Clone the repository to your local machine: git clone https://github.com/N-Yakimov/ps-malware-analysis-toolbox.git
    Execute the desired script or just execute: run.ps1
    Review the generated output located in "Scripts/Exports" and analyze the extracted information.

Please note that these scripts are intended for educational and analysis purposes only. Use them responsibly and ensure compliance with any legal and ethical guidelines in your jurisdiction.
Contributing

Contributions to this repository are welcome. If you have any improvements, bug fixes, or additional scripts related to malware analysis, feel free to submit a pull request. Make sure to follow the repository's code of conduct and provide detailed information about your changes.
License

This project is licensed under the MIT License. You are free to modify and distribute the code, as long as you include the original license and attribute the authors. Read the LICENSE file for more information
