$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Path
$exePath = Join-Path -Path $scriptPath -ChildPath "winpmem_mini_x64_rc2.exe"
$outputFolder = "Scripts/Exports"

if (Test-Path $exePath -PathType Leaf) {
    # The executable file exists, so we can run the command
    if (!(Test-Path $outputFolder -PathType Container)) {
        # Check if the export folder exists, and create it if it doesn't
        New-Item -ItemType Directory -Path $outputFolder | Out-Null
    }
    
    $outputFile = Join-Path -Path $outputFolder -ChildPath "memdump.raw"
    & $exePath $outputFile
}
else {
    # The executable file doesn't exist, display an error message
    Write-Host "Error: 'winpmem_mini_x64_rc2.exe' file not found in the current folder."
    Write-Host "Please download it from the following link: https://github.com/Velocidex/WinPmem"
}