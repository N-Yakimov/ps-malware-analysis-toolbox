$processes = Get-Process | Select-Object -Property Id, Name, Path, Company, Description, StartTime, CPU, Memory, Handles, Threads, FileVersion

$folderPath = "Scripts/Exports"
$csvPath = Join-Path -Path $folderPath -ChildPath "running_processes.csv"

# Check if the export folder exists, and create it if it doesn't
if (!(Test-Path -Path $folderPath)) {
    New-Item -ItemType Directory -Path $folderPath | Out-Null
}

Write-Host "Exporting all running Processes"

$processes | Export-Csv -Path $csvPath -NoTypeInformation

Write-Host "Process information has been recorded and saved to: $csvPath"