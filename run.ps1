$scriptsFolder = Join-Path -Path (Split-Path -Path $MyInvocation.MyCommand.Path) -ChildPath "Scripts"
$scripts = @("logexport.ps1", "memdump.ps1", "processes.ps1", "services.ps1", "netstat.ps1")

# Sort the scripts array to ensure netstat.ps1 is executed last
$scripts = $scripts | Sort-Object { $_ -eq "netstat.ps1" }

foreach ($script in $scripts) {
	Write-Output ""
    $scriptPath = Join-Path -Path $scriptsFolder -ChildPath $script
    try {
        Write-Output "Running $script..."
        & $scriptPath
    }
    catch {
        Write-Output "Error running $script"
    }
}